machine:
  services:
    - docker
  environment:
    USER: p08tf1X
    PASS: p@ssw0Rd
    LOG_TOKEN: $LOG_TOKEN
    HOSTNAME: post-office.htmlgraphic.com
dependencies:
  override:
    - docker build -t postfix .
test:
  override:
    # test postfix
    - docker run -d -p 25:25 --name postfix -e USER=$USER -e PASS=$PASS -e LOG_TOKEN=$LOG_TOKEN -e HOSTNAME=$HOSTNAME postfix; sleep 20
    # test correct env conf
    - docker logs postfix | grep "$USER:$PASS"
    # test logentries sample key
    - docker logs postfix | grep "$LOG_TOKEN"
